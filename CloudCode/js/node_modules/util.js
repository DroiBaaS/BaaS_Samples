const MASTER_KEY = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";
const USER_TABLE = "_User";
const TABLE_SHOP_WINDOW = "ShopWindow";
const TABLE_CART = "Cart";
const TABLE_FIELD_ITEMID = "ItemId";
const TABLE_FIELD_NAME = "Name";
const TABLE_FIELD_NOTE = "Note";
const TABLE_FIELD_PRICE = "Price";
const TABLE_FIELD_QUANTITY = "Quantity";

var getuser = function(userName) {
    return new Promise( (resolve, reject) => {
        var query = Droi.Query(USER_TABLE, MASTER_KEY, 
                Droi.Condition('UserId', Droi.ConditionOP.EQ, userName));
        query.find().events.on("data", function(res) {
            if (res.isSuccess() != true) {
                Droi.debug("fail! call reject.");
                reject(res);
                return;
            }

            Droi.debug("Success! call resolve.");
            resolve(res);
            return;
        });
    });
}

var getCartItems = function() {
    return new Promise( (resolve, reject) => {
        var query = Droi.Query(TABLE_CART, MASTER_KEY);
        query.find().events.on('data', function(res) {
            if (res.isSuccess() != true) {
                Droi.debug("Fail! call reject")
                reject(res);
                return;
            }

            Droi.debug("Success! call resolve.");
            resolve(res);
            return;
        });
    
    })
}

module.exports = {
    getUserObjByName: getuser,
    getCartItems: getCartItems
};